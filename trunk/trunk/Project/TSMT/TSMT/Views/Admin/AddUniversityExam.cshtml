@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.Title = "Thêm thông tin kỳ thi của trường ĐHCĐ";
}
@using TSMT.Models;
@section Breadcrumbs {
    <!--=== Breadcrumbs ===-->
    <div class="breadcrumbs margin-bottom-40">
        <div class="container">
            <h1 class="pull-left">@ViewBag.Title</h1>
            <ul class="pull-right breadcrumb">
                <li><a href="@Url.Action("Index", "Home")">Trang Chủ</a></li>
                <li><a href="@Url.Action("Index", "Admin")">Admin</a></li>
                <li><a href="@Url.Action("ManageUniversityExam", "Admin")">Quản lý đợt thi trường ĐHCĐ</a></li>
                <li class="active">@ViewBag.Title</li>
            </ul>
        </div>
    </div>
}
@Html.Partial("_AdminSidebarPartial")
<script type="text/javascript">
    function checkSubmit() {
        if (document.getElementById("university").selectedIndex == 0 || document.getElementById("examId").selectedIndex == 0) {
            alert("Vui lòng chọn trường hoặc kỳ thi");
            return false;
        } else {
            return true;
        }
    }
</script>
<div class="col-md-9">
    @using (Html.BeginForm("AddNewUniversityExam", "Admin", FormMethod.Post, new { onsubmit = "return checkSubmit();" }))
    {
        <div class="panel panel-red margin-bottom-20">
            <div class="panel-heading">
                <h3 class="panel-title"><i class="icon-list"></i>&nbsp;Thêm thông tin kỳ thi của trường ĐHCĐ
                </h3>
            </div>

            <div class="panel-body">
                <table class="table table-hover">
                    <tr>
                        <td>Trường</td>
                        <td>
                            <select name="UniversityID" id="university" onchange="callAjax(this.value)">
                                <option value="">Chọn trường</option>
                                @foreach (var item in ViewData["unis"] as IEnumerable<University>)
                                {
                                    <option value="@item.UniversityID">@item.Name</option>
                                }
                            </select></td>
                    </tr>
                    <tr>
                        <td>Kỳ thi</td>
                        <td>
                            <select id="examId" name="ExaminationID">
                                <option value="">Chọn đợt thi</option>
                            </select></td>
                    </tr>
                    <tr>
                        <td colspan="2"></td>
                    </tr>
                </table>
            </div>
        </div>
        <input type="button" value="Quay lại" class="btn btn-info" onclick="location.href = '/admin/ManageUniversityExam'" />
        <input type="submit" value="Tạo mới" class="btn btn-info" style="float: right" />
    }
</div>
<script type="text/javascript">
    function callAjax(id) {
        if (document.getElementById("university").selectedIndex == 0) {
            $("#examId").html("");
            $("#examId").append("<option>Chọn đợt thi</option>");
        }
        $.ajax({
            url: '/Admin/LoadExam',
            data: { "id": id },
            type: 'POST',
            success: function (results) {
                $("#examId").html("");
                var r;
                $("#examId").append("<option>Chọn đợt thi</option>");
                for (i in results) {
                    r = results[i];
                    $("#examId").append("<option value=\"" + r.value + "\">" + r.name + "</option>");
                }
            }
        });
    }

</script>
