@using TSMT.Models

@{
    ViewBag.Title = "Tài trợ";
    ViewBag.Active = "AddResource";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<link href="/Content/css/TSMTValidation.css" rel="stylesheet">
<script type="text/javascript" src="/Content/js/TSMTValidation.js"></script>
<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>@ViewBag.Title</title>
    <script type="text/javascript" src="~/Content/js/jquery.js"></script>
    <script type="text/javascript">
        function callAjax(id) {
            if (id == 0) {
                $("#asd").html("");
            }
            else {
                $.ajax({
                    url: 'ResultAjax',
                    data: { "id": id },
                    type: 'GET',
                    success: function (results) {
                        $("#asd").html("");
                        $("#asd").append("<option >-----</option>");
                        for (i in results) {
                            var r = results[i];
                            $("#asd").append("<option value=\"" + r.value + "\">" + r["name"] + "</option>");

                        }
                    }
                });
            }
        }


        function callAjaxcar(id) {
            //var btn = document.getElementById("btnCreateCar");
            if (id == 0) {
                $("#TotalSlots").val("");
                $("#NumberPlate").val("");
                $("#DriverName").val("");
                $("#DriverPhone").val("");
                //btn.style.visibility = "visible";
            }
            else {
                //btn.style.visibility = "hidden";
                $.ajax({
                    url: 'ResultAjaxCar',
                    data: { "id": id },
                    type: 'GET',
                    success: function (results) {
                        $("#TotalSlots").html("");
                        for (i in results) {
                            var r = results[i];
                            $("#TotalSlots").val(r["TotalSlots"]);
                        }
                        $("#NumberPlate").html("");
                        for (i in results) {
                            var r = results[i];
                            $("#NumberPlate").val(r["NumberPlate"]);
                        }
                        $("#DriverName").html("");
                        for (i in results) {
                            var r = results[i];
                            $("#DriverName").val(r["DriverName"]);
                        }
                        $("#DriverPhone").html("");
                        for (i in results) {
                            var r = results[i];
                            $("#DriverPhone").val(r["DriverPhone"]);
                        }
                    }
                });
            }
        }

        function callAjaxlodge(id) {

            if (id == 0) {
                $("#Address").val("");
                $("#TotalRooms").val("");
                $("#TotalSlotsL").val("");
            }
            else {
                $.ajax({
                    url: 'ResultAjaxlodge',
                    data: { "id": id },
                    type: 'GET',
                    success: function (results) {
                        $("#Address").html("");
                        for (i in results) {
                            var r = results[i];
                            $("#Address").val(r["Address"]);
                        }
                        $("#TotalRooms").html("");
                        for (i in results) {
                            var r = results[i];
                            $("#TotalRooms").val(r["TotalRooms"]);
                        }
                        $("#TotalSlotsL").html("");
                        for (i in results) {
                            var r = results[i];
                            $("#TotalSlotsL").val(r["TotalSlotsL"]);
                        }
                    }
                });
            }
        }

        function callAjaxLodgeCharityid(id) {
            if (id == 0) {
                $("#charityid").html("");
            }
            else {
                $.ajax({
                    url: 'ResultAjaxCharityid',
                    data: { "id": id },
                    type: 'GET',
                    success: function (results) {
                        $("#charityid").html("");

                        for (i in results) {
                            var r = results[i];
                            $("#charityid").val(r["charityid"]);

                        }
                    }
                });
            }
        }
    </script>
</head>
<body>

    @section Breadcrumbs {
        <!--=== Breadcrumbs ===-->
        <div class="breadcrumbs margin-bottom-40">
            <div class="container">
                <h1 class="pull-left">@ViewBag.Title</h1>
                <ul class="pull-right breadcrumb">
                    <li><a href="@Url.Action("Index", "Home")">Trang Chủ</a></li>
                    <li><a href="@Url.Action("Index", "Sponsor")">Nhà tài trợ</a></li>
                    <li class="active">@ViewBag.Title</li>
                </ul>
            </div>
        </div>
    }
    @Html.Partial("_SponsorSidebarPartial")
    @using (Html.BeginForm("AddResource", "Sponsor", FormMethod.Post, new { id = "FormValidate" }))
    {
        <div class="col-md-9">
            @* <form method="post" action="/Sponsor/AddResource">*@
            <div class="panel panel-green">
                <div class="panel-heading">
                    <h3 class="panel-title"><i class="icon-user"></i>Thông tin tài trợ</h3>
                </div>
                <div class="panel-body">

                    <table>
                        <tr>
                            <td>Tài Trợ Cho: <span class="required">*</span></td>
                            <td>
                                <select id="qwe" onchange="callAjax(this.value)" class="form-control">
                                    <option value="0" selected>---</option>
                                    @foreach (var item in ViewData["Exam"] as IEnumerable<Examination>)
                                    {
                                        <option value="@item.ExaminationID">@item.Name</option>
                                    }
                                </select>
                            </td>
                            <td>Tổ Chức: <span class="required">*</span></td>
                            <td>
                                <select id="asd" name="asd" onchange="callAjaxLodgeCharityid(this.value)" class="form-control"></select>
                            </td>
                            <input type="hidden" name="charityid" id="charityid" />
                        </tr>
                        <tr>
                            <td>Hình Thức <span class="required">*</span></td>
                            <td>
                                <select id="resource" name="resource" onchange="changeRole(this.options[this.selectedIndex].text);" class="form-control">
                                    <option value="null" selected>---</option>
                                    <option value="1">Tiền</option>
                                    <option value="2">Xe</option>
                                    <option value="3">Chỗ Ở</option>
                                </select>
                            </td>
                        </tr>
                    </table>

                    <div id="Tiền" style="display: none">
                        <table class="table table-hover">
                            <tr>
                                <td>Số Tiền <span class="required">*</span></td>
                                <td>
                                    <input type="text" name="FundSponsored" id="input" class="form-control" />
                                    <script>
                                        $("#input").priceFormat({ prefix: '', centsLimit: 0 });
                                    </script>
                                </td>
                                <td>VNĐ</td>
                            </tr>
                        </table>
                    </div>

                    <div id="Xe" style="display: none">
                        <div id="showMessage" class="alert alert-danger fade in" style="display: none">
                            @*<button type="button" class="close" data-dismiss="alert">×</button>*@
                            <strong>Bạn không có xe để tài trợ!</strong> Bạn hãy tạo mới xe cho mình.
                        </div>
                        <table class="table table-hover" id="showdata">
                            @if (((IEnumerable<Car>)ViewData["Car"]).Count() == 0)
                            {
                                <tr>
                                    <td>
                                        <script type="text/javascript">
                                            document.getElementById("showdata").style.display = "none";
                                            document.getElementById("showMessage").style.display = "block";
                                        </script>
                                    </td>
                                </tr>
                            }
                            else
                            {
                                <tr>
                                    <td>Xe đã có - Biển Số Xe: <span class="required">*</span>
                                    </td>
                                    <td>
                                        <select id="carsource" name="carId" onchange="callAjaxcar(this.value)" class="form-control">
                                            <option value="0" selected>---</option>
                                            @foreach (var item in ViewData["Car"] as IEnumerable<Car>)
                                            {
                                                <option value="@item.CarID">@item.NumberPlate</option>
                                            }
                                        </select>
                                    </td>
                                </tr>
                                <tr style="display: none">
                                    <td>
                                        <input style="display: none" type="text" id="NumberPlate" name="NumberPlate" readonly="true" class="form-control" /></td>
                                </tr>
                                <tr>
                                    <td>Tổng số chỗ ngồi</td>
                                    <td>
                                        <input type="text" id="TotalSlots" name="TotalSlots" readonly="true" class="form-control" /></td>
                                </tr>
                                <tr>
                                    <td>Tên tài xế</td>
                                    <td>
                                        <input type="text" id="DriverName" name="DriverName" readonly="true" class="form-control" /></td>
                                </tr>
                                <tr>
                                    <td>Số điện thoại tài xế</td>
                                    <td>
                                        <input type="text" id="DriverPhone" name="DriverPhone" readonly="true" class="form-control" /></td>
                                </tr>
                            }
                        </table>
                    </div>

                    <div id="Chỗ Ở" style="display: none">
                        <table class="table table-hover">
                            <tr>
                                <td>Chỗ ở đã có - Địa Chỉ: <span class="required">*</span>
                                </td>
                                <td>
                                    <select id="lodgesource" name="lodgeId" onchange="callAjaxlodge(this.value)" class="form-control">
                                        <option value="0" selected>---</option>
                                        @foreach (var item in ViewData["Lodge"] as IEnumerable<Lodge>)
                                        {
                                            <option value="@item.LodgeID">@item.Address</option>
                                        }
                                    </select>

                                </td>
                            </tr>
                            <tr style="display: none">
                                <td>
                                    <input type="text" id="Address" name="Address" readonly="true" class="form-control" /></td>
                            </tr>
                            <tr>
                                <td>Tổng số phòng</td>
                                <td>
                                    <input type="text" id="TotalRooms" name="TotalRooms" readonly="true" class="form-control" /></td>

                            </tr>
                            <tr>
                                <td>Tổng số chỗ trọ</td>
                                <td>
                                    <input type="text" id="TotalSlotsL" name="TotalSlotsL" readonly="true" class="form-control" /></td>

                            </tr>
                        </table>
                    </div>
                </div>
            </div>
            <div style="float: right">
                <button type="submit" class="btn-u btn-u-sea"><i class="icon-plus">&nbsp;Tài Trợ</i></button>
            </div>
            <button type="button" onclick="location.href ='/Sponsor/Index/'" class="btn-u btn-u-default"><i class="icon-chevron-sign-left"></i>&nbsp;Quay lại</button>

        </div>
    }
</body>
</html>
<script type="text/javascript">
    var currentRole = "null";
    function changeRole(newRole) {
        if (currentRole !== "null") {
            document.getElementById(currentRole).style.display = 'none';
        }
        document.getElementById(newRole).style.display = 'inline';
        currentRole = newRole;
    }

</script>
@*<script type="text/javascript">
    $(document).ready(function () {
        var ex = /^[^\-]$/;
        $("#qwe").blur(function () { checkRegex("qwe", ex, "Vui lòng chọn đợt thi", true) });
        $("#asd").blur(function () { checkRegex("asd", ex, "VUi lòng chọn tổ chức", true) });
        $("#resource").blur(function () { checkRegex("resource", ex, "VUi lòng chọn tổ chức", true) });
        $("#FormValidate").submit(function (e) {
            var isValidated = true;
            isValidated = checkRegex("qwe", ex, "Vui lòng chọn đợt thi", true) && isValidated;
            isValidated = checkRegex("asd", ex, "VUi lòng chọn tổ chức", true) && isValidated;
            isValidated = checkRegex("resource", ex, "VUi lòng chọn hình thức tài trợ", true) && isValidated;
            if (isValidated) return true;
            e.preventDefault();
        });
    });
</script>*@
